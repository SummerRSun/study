*** Settings ***
Library           RequestsLibrary
Library           DatabaseLibrary
Library           Collections

*** Variables ***
${URL}            http://10.1.50.225:7000/boltdog
&{Header}         x-uyun-login-token=3cc40c1b2ded40958ff64efbd291707e
@{boltdogmysql}    database='boltdog', user='root',password='123456',host='10.1.50.225',port=3306
&{Hub_Type}       private=0    public=1
${private_file}    batch
${public_file}    public

*** Test Cases ***
private_filelist
    [Documentation]    Request URL:http://10.1.50.225:7000/boltdog/api/v1/hub/query?currentPage=1&pageSize=10&hubType=0
    ...    Request Method:GET
    ...    Data:{"data":[{"content":"","createTime":1463218578000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/tests.py","fileName":"tests.py","hubType":0,"id":"8d47b21e-9084-4abc-a0fd-11941f4a12de","modifyTime":1463218578000,"modifyUser":null,"size":830,"type":"application/octet-stream"},{"content":"","createTime":1463124267000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/jdk-8u45-linux-x64.gz","fileName":"jdk-8u45-linux-x64.gz","hubType":0,"id":"7a47bce4-a2ed-45e6-a024-690feab4d609","modifyTime":1463124267000,"modifyUser":null,"size":173271626,"type":"application/octet-stream"},{"content":"","createTime":1463124235000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/apache-tomcat-8.0.33.tar.gz","fileName":"apache-tomcat-8.0.33.tar.gz","hubType":0,"id":"c62bf770-8bb9-4eab-a75f-5829f92f1fed","modifyTime":1463124235000,"modifyUser":null,"size":9250362,"type":"application/octet-stream"},{"content":"","createTime":1463124229000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/apache-activemq-5.13.2-bin.tar.gz","fileName":"apache-activemq-5.13.2-bin.tar.gz","hubType":0,"id":"fe839ce6-5dda-480f-ac50-910ac4cad2c6","modifyTime":1463124229000,"modifyUser":null,"size":53675823,"type":"application/octet-stream"},{"content":"","createTime":1463116871000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/shell.sh","fileName":"shell.sh","hubType":0,"id":"a3ef1621-e603-4f32-88a5-7d3a75f84ddb","modifyTime":1463116871000,"modifyUser":null,"size":125,"type":"application/octet-stream"},{"content":"","createTime":1463116870000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/script_testfile.zip","fileName":"script_testfile.zip","hubType":0,"id":"2e1d50d3-d1a0-4bd4-bf1e-dabe05a5c1e1","modifyTime":1463116870000,"modifyUser":null,"size":741,"type":"application/octet-stream"},{"content":"","createTime":1463116869000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/python-test.py","fileName":"python-test.py","hubType":0,"id":"dd8f9aff-b859-4cd1-8b45-167a680e2af1","modifyTime":1463116869000,"modifyUser":null,"size":339,"type":"application/octet-stream"},{"content":"","createTime":1463116868000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/batch.bat","fileName":"batch.bat","hubType":0,"id":"5f1d27e9-a826-4463-9495-da39096ac001","modifyTime":1463116868000,"modifyUser":null,"size":138,"type":"application/octet-stream"},{"content":"","createTime":1463111390000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/shell.sh","fileName":"shell.sh","hubType":0,"id":"4bcd7e97-9d5c-411a-97bf-07a0469b9bb6","modifyTime":1463111390000,"modifyUser":null,"size":125,"type":"application/octet-stream"},{"content":"","createTime":1463111389000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/python-test.py","fileName":"python-test.py","hubType":0,"id":"79d35d24-e549-408e-b77a-dbd974ea1ef5","modifyTime":1463111389000,"modifyUser":null,"size":339,"type":"application/octet-stream"}],"total":12}
    Create Session    private_filelist_api    ${URL}
    ${addr}    Get Request    private_filelist_api    /api/v1/hub/query?currentPage=1&pageSize=10&hubType=0    headers=&{Header}
    Should Be Equal As Strings    ${addr.status_code}    200
    Log    ${addr.content}
    ${responsedata}    To Json    ${addr.content}
    ${keys}    Get Dictionary Keys    ${responsedata}
    ${items}    Get Dictionary Items    ${responsedata}
    ${values}    Get Dictionary Values    ${responsedata}
    ${data}    Get From Dictionary    ${responsedata}    data
    ${num}    get length    ${data}
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${res_total}    query    select count(*) from file_hub where hub_type=0 and origin_type=1
    ${name}    query    select file_name from file_hub where hub_type=0 and origin_type=1 \ ORDER BY create_time DESC limit ${num}
    Disconnect From Database
    Dictionary Should Contain Item    ${responsedata}    total    ${res_total[0][0]}    msg=total is not right
    ${items_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    ${items_tmp}    Get From Dictionary    ${items[1][${i}]}    fileName
    \    Append To List    ${items_name_list}    ${items_tmp}
    Sort List    ${items_name_list}
    ${mysql_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    Append To List    ${mysql_name_list}    ${name[${i}][0]}
    Sort List    ${mysql_name_list}
    Lists Should Be Equal    ${items_name_list}    ${mysql_name_list}    msg=None    values=True    names=None

privatefile_query
    [Documentation]    Request URL:http://10.1.50.225:7000/boltdog/api/v1/hub/query?currentPage=1&pageSize=10&fileName=batch
    ...    Request Method:GET
    ...    Data:{"data":[{"content":"","createTime":1463116868000,"createUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/batch.bat","fileName":"batch.bat","hubType":0,"id":"5f1d27e9-a826-4463-9495-da39096ac001","modifyTime":1463116868000,"modifyUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"size":138,"type":"application/octet-stream"},{"content":"","createTime":1463111388000,"createUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/batch.bat","fileName":"batch.bat","hubType":0,"id":"a9ffaa03-1717-453c-bcf7-ff6521487073","modifyTime":1463111388000,"modifyUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"size":138,"type":"application/octet-stream"}],"total":2}
    Create Session    privatefile_queryt_api    ${URL}
    ${addr}    Get Request    privatefile_queryt_api    /api/v1/hub/query?currentPage=1&pageSize=10&fileName=${private_file}    headers=&{Header}
    Should Be Equal As Strings    ${addr.status_code}    200
    Log    ${addr.content}
    ${responsedata}    To Json    ${addr.content}
    ${keys}    Get Dictionary Keys    ${responsedata}
    ${items}    Get Dictionary Items    ${responsedata}
    ${values}    Get Dictionary Values    ${responsedata}
    ${data}    Get From Dictionary    ${responsedata}    data
    ${num}    get length    ${data}
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${res_total}    query    select count(*) from file_hub where hub_type=0 and origin_type=1 \ and file_name like '%${private_file}%'
    ${name}    query    select file_name from file_hub where hub_type=0 and origin_type=1 \ and file_name like '%${private_file}%' ORDER BY create_time DESC limit ${num}
    log    select count(*) from file_hub where hub_type=0 and file_name='%${private_file}%'
    Disconnect From Database
    Dictionary Should Contain Item    ${responsedata}    total    ${res_total[0][0]}    msg=total is not right
    ${items_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    ${items_tmp}    Get From Dictionary    ${items[1][${i}]}    fileName
    \    Append To List    ${items_name_list}    ${items_tmp}
    Sort List    ${items_name_list}
    ${mysql_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    Append To List    ${mysql_name_list}    ${name[${i}][0]}
    Sort List    ${mysql_name_list}
    Lists Should Be Equal    ${items_name_list}    ${mysql_name_list}    msg=None    values=True    names=None

public_filelist
    [Documentation]    Request URL:http://10.1.50.225:7000/boltdog/api/v1/hub/query?currentPage=1&pageSize=10&hubType=0
    ...    Request Method:GET
    ...    Data:{"data":[{"content":"","createTime":1463218578000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/tests.py","fileName":"tests.py","hubType":0,"id":"8d47b21e-9084-4abc-a0fd-11941f4a12de","modifyTime":1463218578000,"modifyUser":null,"size":830,"type":"application/octet-stream"},{"content":"","createTime":1463124267000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/jdk-8u45-linux-x64.gz","fileName":"jdk-8u45-linux-x64.gz","hubType":0,"id":"7a47bce4-a2ed-45e6-a024-690feab4d609","modifyTime":1463124267000,"modifyUser":null,"size":173271626,"type":"application/octet-stream"},{"content":"","createTime":1463124235000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/apache-tomcat-8.0.33.tar.gz","fileName":"apache-tomcat-8.0.33.tar.gz","hubType":0,"id":"c62bf770-8bb9-4eab-a75f-5829f92f1fed","modifyTime":1463124235000,"modifyUser":null,"size":9250362,"type":"application/octet-stream"},{"content":"","createTime":1463124229000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/apache-activemq-5.13.2-bin.tar.gz","fileName":"apache-activemq-5.13.2-bin.tar.gz","hubType":0,"id":"fe839ce6-5dda-480f-ac50-910ac4cad2c6","modifyTime":1463124229000,"modifyUser":null,"size":53675823,"type":"application/octet-stream"},{"content":"","createTime":1463116871000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/shell.sh","fileName":"shell.sh","hubType":0,"id":"a3ef1621-e603-4f32-88a5-7d3a75f84ddb","modifyTime":1463116871000,"modifyUser":null,"size":125,"type":"application/octet-stream"},{"content":"","createTime":1463116870000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/script_testfile.zip","fileName":"script_testfile.zip","hubType":0,"id":"2e1d50d3-d1a0-4bd4-bf1e-dabe05a5c1e1","modifyTime":1463116870000,"modifyUser":null,"size":741,"type":"application/octet-stream"},{"content":"","createTime":1463116869000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/python-test.py","fileName":"python-test.py","hubType":0,"id":"dd8f9aff-b859-4cd1-8b45-167a680e2af1","modifyTime":1463116869000,"modifyUser":null,"size":339,"type":"application/octet-stream"},{"content":"","createTime":1463116868000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/batch.bat","fileName":"batch.bat","hubType":0,"id":"5f1d27e9-a826-4463-9495-da39096ac001","modifyTime":1463116868000,"modifyUser":null,"size":138,"type":"application/octet-stream"},{"content":"","createTime":1463111390000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/shell.sh","fileName":"shell.sh","hubType":0,"id":"4bcd7e97-9d5c-411a-97bf-07a0469b9bb6","modifyTime":1463111390000,"modifyUser":null,"size":125,"type":"application/octet-stream"},{"content":"","createTime":1463111389000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/python-test.py","fileName":"python-test.py","hubType":0,"id":"79d35d24-e549-408e-b77a-dbd974ea1ef5","modifyTime":1463111389000,"modifyUser":null,"size":339,"type":"application/octet-stream"}],"total":12}
    [Template]
    Create Session    public_filelist_api    ${URL}
    ${addr}    Get Request    public_filelist_api    /api/v1/hub/query?currentPage=1&pageSize=10&hubType=1    headers=&{Header}
    Should Be Equal As Strings    ${addr.status_code}    200
    Log    ${addr.content}
    ${responsedata}    To Json    ${addr.content}
    ${keys}    Get Dictionary Keys    ${responsedata}
    ${items}    Get Dictionary Items    ${responsedata}
    ${values}    Get Dictionary Values    ${responsedata}
    ${data}    Get From Dictionary    ${responsedata}    data
    ${num}    get length    ${data}
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${res_total}    query    select count(*) from file_hub where hub_type=1 and origin_type=1
    ${name}    query    select file_name from file_hub where hub_type=1 and origin_type=1 \ ORDER BY create_time DESC limit ${num}
    Disconnect From Database
    Dictionary Should Contain Item    ${responsedata}    total    ${res_total[0][0]}    msg=total is not right
    ${items_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    ${items_tmp}    Get From Dictionary    ${items[1][${i}]}    fileName
    \    Append To List    ${items_name_list}    ${items_tmp}
    Sort List    ${items_name_list}
    ${mysql_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    Append To List    ${mysql_name_list}    ${name[${i}][0]}
    Sort List    ${mysql_name_list}
    Lists Should Be Equal    ${items_name_list}    ${mysql_name_list}    msg=None    values=True    names=None

public_query
    [Documentation]    Request URL:http://10.1.50.225:7000/boltdog/api/v1/hub/query?currentPage=1&pageSize=10&fileName=batch
    ...    Request Method:GET
    ...    Data:{"data":[{"content":"","createTime":1463116868000,"createUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/batch.bat","fileName":"batch.bat","hubType":0,"id":"5f1d27e9-a826-4463-9495-da39096ac001","modifyTime":1463116868000,"modifyUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"size":138,"type":"application/octet-stream"},{"content":"","createTime":1463111388000,"createUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/batch.bat","fileName":"batch.bat","hubType":0,"id":"a9ffaa03-1717-453c-bcf7-ff6521487073","modifyTime":1463111388000,"modifyUser":{"realname":"yetao","userId":"3cc40c1b2ded40958ff64efbd291707e"},"size":138,"type":"application/octet-stream"}],"total":2}
    Create Session    public_query_api    ${URL}
    ${addr}    Get Request    public_query_api    /api/v1/hub/query?currentPage=1&pageSize=10&fileName=${public_file}    headers=&{Header}
    Should Be Equal As Strings    ${addr.status_code}    200
    Log    ${addr.content}
    ${responsedata}    To Json    ${addr.content}
    ${keys}    Get Dictionary Keys    ${responsedata}
    ${items}    Get Dictionary Items    ${responsedata}
    ${values}    Get Dictionary Values    ${responsedata}
    ${data}    Get From Dictionary    ${responsedata}    data
    ${num}    get length    ${data}
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${res_total}    query    select count(*) from file_hub where hub_type=1 and origin_type=1 \ and file_name like '%${private_file}%'
    ${name}    query    select file_name from file_hub where hub_type=1 and origin_type=1 \ and file_name like '%${private_file}%' ORDER BY create_time DESC limit ${num}
    log    select count(*) from file_hub where hub_type=0 and file_name='%${private_file}%'
    Disconnect From Database
    Dictionary Should Contain Item    ${responsedata}    total    ${res_total[0][0]}    msg=total is not right
    ${items_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    ${items_tmp}    Get From Dictionary    ${items[1][${i}]}    fileName
    \    Append To List    ${items_name_list}    ${items_tmp}
    Sort List    ${items_name_list}
    ${mysql_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    Append To List    ${mysql_name_list}    ${name[${i}][0]}
    Sort List    ${mysql_name_list}
    Lists Should Be Equal    ${items_name_list}    ${mysql_name_list}    msg=None    values=True    names=None

private_filedelete-batch
    [Documentation]    Request URL:http://10.1.50.225:7000/boltdog/api/v1/hub/delete-batch?ids=79d35d24-e549-408e-b77a-dbd974ea1ef5,4576ec6b-afd3-4e8b-81fe-f28f3cb3f052,a9ffaa03-1717-453c-bcf7-ff6521487073
    ...    Request Method:POST
    ...    Data:["79d35d24-e549-408e-b77a-dbd974ea1ef5","4576ec6b-afd3-4e8b-81fe-f28f3cb3f052","a9ffaa03-1717-453c-bcf7-ff6521487073"]
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${fileid}    query    select id from file_hub where hub_type=0 and origin_type=1 ORDER BY create_time DESC limit 1
    Disconnect From Database
    Create Session    private_filedelete-batch_api    ${URL}
    ${addr}    Post Request    private_filedelete-batch_api    /api/v1/hub/delete-batch?ids=${fileid[0][0]}    headers=&{Header}
    Should Be Equal As Strings    ${addr.status_code}    200
    Logmany    ${addr.content}    ==================
    ${responsedata}    To Json    ${addr.content}
    ${num}    get length    ${responsedata}
    logmany    select count(*) from file_hub where hub_type=0 and origin_type=1 and id='${fileid}'    ==================
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${res_total}    query    select count(*) from file_hub where hub_type=0 and origin_type=1 and id='${fileid[0][0]}'
    Disconnect From Database
    Should Be Equal As Strings    ${res_total[0][0]}    0    msg=total is not right

private_fileupload
    [Documentation]    Request URL:http://10.1.50.225:7000/boltdog/api/v1/hub/save
    ...    Request Method:POST
    ...    Data:{"data":[{"content":"","createTime":1463218578000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/tests.py","fileName":"tests.py","hubType":0,"id":"8d47b21e-9084-4abc-a0fd-11941f4a12de","modifyTime":1463218578000,"modifyUser":null,"size":830,"type":"application/octet-stream"},{"content":"","createTime":1463124267000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/jdk-8u45-linux-x64.gz","fileName":"jdk-8u45-linux-x64.gz","hubType":0,"id":"7a47bce4-a2ed-45e6-a024-690feab4d609","modifyTime":1463124267000,"modifyUser":null,"size":173271626,"type":"application/octet-stream"},{"content":"","createTime":1463124235000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/apache-tomcat-8.0.33.tar.gz","fileName":"apache-tomcat-8.0.33.tar.gz","hubType":0,"id":"c62bf770-8bb9-4eab-a75f-5829f92f1fed","modifyTime":1463124235000,"modifyUser":null,"size":9250362,"type":"application/octet-stream"},{"content":"","createTime":1463124229000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/apache-activemq-5.13.2-bin.tar.gz","fileName":"apache-activemq-5.13.2-bin.tar.gz","hubType":0,"id":"fe839ce6-5dda-480f-ac50-910ac4cad2c6","modifyTime":1463124229000,"modifyUser":null,"size":53675823,"type":"application/octet-stream"},{"content":"","createTime":1463116871000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/shell.sh","fileName":"shell.sh","hubType":0,"id":"a3ef1621-e603-4f32-88a5-7d3a75f84ddb","modifyTime":1463116871000,"modifyUser":null,"size":125,"type":"application/octet-stream"},{"content":"","createTime":1463116870000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/script_testfile.zip","fileName":"script_testfile.zip","hubType":0,"id":"2e1d50d3-d1a0-4bd4-bf1e-dabe05a5c1e1","modifyTime":1463116870000,"modifyUser":null,"size":741,"type":"application/octet-stream"},{"content":"","createTime":1463116869000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/python-test.py","fileName":"python-test.py","hubType":0,"id":"dd8f9aff-b859-4cd1-8b45-167a680e2af1","modifyTime":1463116869000,"modifyUser":null,"size":339,"type":"application/octet-stream"},{"content":"","createTime":1463116868000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/batch.bat","fileName":"batch.bat","hubType":0,"id":"5f1d27e9-a826-4463-9495-da39096ac001","modifyTime":1463116868000,"modifyUser":null,"size":138,"type":"application/octet-stream"},{"content":"","createTime":1463111390000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/shell.sh","fileName":"shell.sh","hubType":0,"id":"4bcd7e97-9d5c-411a-97bf-07a0469b9bb6","modifyTime":1463111390000,"modifyUser":null,"size":125,"type":"application/octet-stream"},{"content":"","createTime":1463111389000,"createUser":null,"downloadUrl":"http://10.1.51.158/v2/tfs1/3/1/file/upload/python-test.py","fileName":"python-test.py","hubType":0,"id":"79d35d24-e549-408e-b77a-dbd974ea1ef5","modifyTime":1463111389000,"modifyUser":null,"size":339,"type":"application/octet-stream"}],"total":12}
    [Template]
    Create Session    private_fileupload_api    ${URL}
    ${addr}    Get Request    private_fileupload_api    /api/v1/hub/save    headers=&{Header}
    Should Be Equal As Strings    ${addr.status_code}    200
    Log    ${addr.content}
    ${responsedata}    To Json    ${addr.content}
    ${keys}    Get Dictionary Keys    ${responsedata}
    ${items}    Get Dictionary Items    ${responsedata}
    ${values}    Get Dictionary Values    ${responsedata}
    ${data}    Get From Dictionary    ${responsedata}    data
    ${num}    get length    ${data}
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${res_total}    query    select count(*) from file_hub where hub_type=1 and origin_type=1
    ${name}    query    select file_name from file_hub where hub_type=1 and origin_type=1 \ ORDER BY create_time DESC limit ${num}
    Disconnect From Database
    Dictionary Should Contain Item    ${responsedata}    total    ${res_total[0][0]}    msg=total is not right
    ${items_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    ${items_tmp}    Get From Dictionary    ${items[1][${i}]}    fileName
    \    Append To List    ${items_name_list}    ${items_tmp}
    Sort List    ${items_name_list}
    ${mysql_name_list}    Create List
    : FOR    ${i}    IN RANGE    ${num}
    \    Append To List    ${mysql_name_list}    ${name[${i}][0]}
    Sort List    ${mysql_name_list}
    Lists Should Be Equal    ${items_name_list}    ${mysql_name_list}    msg=None    values=True    names=None

private_filedel
    [Documentation]    Request URL:http://10.1.50.225:7000/boltdog/api/v1/hub/delete?id=d9d59f64-f5c0-47ff-889a-c6e1a52c3bda
    ...    Request Method:POST
    ...    Data:["79d35d24-e549-408e-b77a-dbd974ea1ef5","4576ec6b-afd3-4e8b-81fe-f28f3cb3f052","a9ffaa03-1717-453c-bcf7-ff6521487073"]
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${fileid}    query    select id from file_hub where hub_type=0 and origin_type=1 ORDER BY create_time DESC limit 1
    Disconnect From Database
    Create Session    private_filedel_api    ${URL}
    ${addr}    Post Request    private_filedel_api    /api/v1/hub/delete?id=${fileid[0][0]}    headers=&{Header}
    Should Be Equal As Strings    ${addr.status_code}    200
    Logmany    ${addr.content}    ==================
    ${responsedata}    To Json    ${addr.content}
    ${keys}    Get Dictionary Keys    ${responsedata}
    ${items}    Get Dictionary Items    ${responsedata}
    ${values}    Get Dictionary Values    ${responsedata}
    Connect To Database Using Custom Params    pymysql    @{boltdogmysql}
    ${res_total}    query    select count(*) from file_hub where hub_type=0 and origin_type=1 and id='${fileid[0][0]}'
    Disconnect From Database
    Should Be Equal As Strings    ${res_total[0][0]}    0    msg=total is not right
    [Teardown]
